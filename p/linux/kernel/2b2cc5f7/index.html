<!doctype html><html><title>网络子系统初始化</title><meta name=description content="网络设备初始化 内核初始化代码(init/main.c &amp;ndash;&amp;gt; asmlinkage __visible void __init start_kernel(void))
ps：这里只介绍网络子系统的初始化流程。
系统启动时会执行start_kernel对内核的各个子系统进行初始化。start_kernel会进行必要的初始化任务，比如init_IRQ和softirq_init进行硬中断和软中断初始化,在rest_init中会调用内核线程函数创建一个线程执行kernel_init继续进行其它初始化，start_kernel函数将会继续执行下去并退出。在kernel_init函数中的执行关系kernel_init_freeable()&amp;ndash;&amp;gt;do_basic_setup()&amp;ndash;&amp;gt;do_initcalls()，在do_initcalls函数中，会对调用各个子系统的初始化函数，类似subsys_initcall(net_dev_init)函数。其中net_dev_initnet/core/dev.c为网络设备的初始化函数
内核子系统和编译到内核的驱动都是通过do_initcalls进行初始化的
"><meta name=generator content="Hugo 0.101.0"><meta property="og:title" content="网络子系统初始化"><meta property="og:description" content="网络设备初始化
内核初始化代码(init/main.c &ndash;> asmlinkage __visible void __init start_kernel(void))

ps：这里只介绍网络子系统的初始化流程。

系统启动时会执行start_kernel对内核的各个子系统进行初始化。start_kernel会进行必要的初始化任务，比如init_IRQ和softirq_init进行硬中断和软中断初始化,在rest_init中会调用内核线程函数创建一个线程执行kernel_init继续进行其它初始化，start_kernel函数将会继续执行下去并退出。在kernel_init函数中的执行关系kernel_init_freeable()&ndash;>do_basic_setup()&ndash;>do_initcalls()，在do_initcalls函数中，会对调用各个子系统的初始化函数，类似subsys_initcall(net_dev_init)函数。其中net_dev_initnet/core/dev.c为网络设备的初始化函数
内核子系统和编译到内核的驱动都是通过do_initcalls进行初始化的"><meta property="og:type" content="article"><meta property="og:url" content="https://arair.net/p/linux/kernel/2b2cc5f7/"><meta property="article:section" content="p"><meta property="article:published_time" content="2021-01-24T11:24:01+08:00"><meta property="article:modified_time" content="2021-09-12T18:05:24+08:00"><meta itemprop=name content="网络子系统初始化"><meta itemprop=description content="网络设备初始化
内核初始化代码(init/main.c &ndash;> asmlinkage __visible void __init start_kernel(void))

ps：这里只介绍网络子系统的初始化流程。

系统启动时会执行start_kernel对内核的各个子系统进行初始化。start_kernel会进行必要的初始化任务，比如init_IRQ和softirq_init进行硬中断和软中断初始化,在rest_init中会调用内核线程函数创建一个线程执行kernel_init继续进行其它初始化，start_kernel函数将会继续执行下去并退出。在kernel_init函数中的执行关系kernel_init_freeable()&ndash;>do_basic_setup()&ndash;>do_initcalls()，在do_initcalls函数中，会对调用各个子系统的初始化函数，类似subsys_initcall(net_dev_init)函数。其中net_dev_initnet/core/dev.c为网络设备的初始化函数
内核子系统和编译到内核的驱动都是通过do_initcalls进行初始化的"><meta itemprop=datePublished content="2021-01-24T11:24:01+08:00"><meta itemprop=dateModified content="2021-09-12T18:05:24+08:00"><meta itemprop=wordCount content="1790"><meta itemprop=keywords content="linux,driver,"><style type=text/css>.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto;padding:45px;font-family:Consolas,courier new,monospace}@media(max-width:767px){.markdown-body{padding:15px}}</style><script>function setTheme({el:e=document.documentElement,mode:t="auto",light:n="light",dark:s="dark"}){e.dataset.colorMode=t,e.dataset.lightTheme=n,e.dataset.darkTheme=s}let prefersDarkMode=window.matchMedia("(prefers-color-scheme: dark)").matches;prefersDarkMode&&setTheme({mode:"dark"})</script><body id=content class=markdown-body><body><div id=post class=post><article><header><h1 class=post-title>网络子系统初始化</h1><p><small>2021-01-24, updated 2021-09-12</small></p></header><aside><nav id=TableOfContents></nav></aside><h1 id=网络设备初始化>网络设备初始化</h1><p>内核初始化代码(init/main.c &ndash;> asmlinkage __visible void __init start_kernel(void))</p><blockquote><p>ps：这里只介绍网络子系统的初始化流程。</p></blockquote><p>系统启动时会执行start_kernel对内核的各个子系统进行初始化。start_kernel会进行必要的初始化任务，比如init_IRQ和softirq_init进行硬中断和软中断初始化,在rest_init中会调用内核线程函数创建一个线程执行kernel_init继续进行其它初始化，start_kernel函数将会继续执行下去并退出。在kernel_init函数中的执行关系kernel_init_freeable()&ndash;>do_basic_setup()&ndash;>do_initcalls()，在do_initcalls函数中，会对调用各个子系统的初始化函数，类似subsys_initcall(net_dev_init)函数。其中net_dev_init<code>net/core/dev.c</code>为网络设备的初始化函数</p><p>内核子系统和编译到内核的驱动都是通过do_initcalls进行初始化的</p><p>以下为相关的部分代码
linux-4.4.0</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">158
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">159
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">160
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">161
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">162
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">163
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">164
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">165
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">166
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">167
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">168
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">169
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">170
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">171
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">172
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">173
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">174
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">175
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">176
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">177
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">178
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">179
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">180
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">181
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">182
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">183
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">184
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">185
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">186
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">187
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">188
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">189
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">190
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">191
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">192
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">193
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">194
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">195
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">196
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">197
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">198
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">199
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">200
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">201
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">202
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">203
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">204
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">205
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">206
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">207
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">208
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">209
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">210
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">211
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">212
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">213
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">214
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">215
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">216
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">217
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">218
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">219
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">220
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">221
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">222
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>start_kernel()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>    boot_cpu_init();
</span></span><span style=display:flex><span>    page_address_init();
</span></span><span style=display:flex><span>    pr_notice(<span style=color:#f1fa8c>&#34;%s&#34;</span>, linux_banner);
</span></span><span style=display:flex><span>    setup_arch(<span style=color:#ff79c6>&amp;</span>command_line);
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>    early_irq_init();
</span></span><span style=display:flex><span>    <span style=color:#6272a4>// 硬中断初始化
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    init_IRQ();
</span></span><span style=display:flex><span>    tick_init();
</span></span><span style=display:flex><span>    rcu_init_nohz();
</span></span><span style=display:flex><span>    init_timers();
</span></span><span style=display:flex><span>    hrtimers_init();
</span></span><span style=display:flex><span>    <span style=color:#6272a4>// 软中断初始化
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    softirq_init();
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>    rest_init();
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> noinline <span style=color:#8be9fd>void</span> __ref rest_init(<span style=color:#8be9fd>void</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>struct</span> task_struct <span style=color:#ff79c6>*</span>tsk;
</span></span><span style=display:flex><span>	<span style=color:#8be9fd>int</span> pid;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	rcu_scheduler_starting();
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * We need to spawn init first so that it obtains pid 1, however
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * the init task will end up wanting to create kthreads, which, if
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * we schedule it before we create kthreadd, will OOPS.
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 */</span>
</span></span><span style=display:flex><span>	pid <span style=color:#ff79c6>=</span> kernel_thread(kernel_init, <span style=color:#8be9fd;font-style:italic>NULL</span>, CLONE_FS);
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * Pin init on the boot CPU. Task migration is not properly working
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * until sched_init_smp() has been run. It will set the allowed
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * CPUs for init to the non isolated CPUs.
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 */</span>
</span></span><span style=display:flex><span>	rcu_read_lock();
</span></span><span style=display:flex><span>	tsk <span style=color:#ff79c6>=</span> find_task_by_pid_ns(pid, <span style=color:#ff79c6>&amp;</span>init_pid_ns);
</span></span><span style=display:flex><span>	set_cpus_allowed_ptr(tsk, cpumask_of(smp_processor_id()));
</span></span><span style=display:flex><span>	rcu_read_unlock();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	numa_default_policy();
</span></span><span style=display:flex><span>	pid <span style=color:#ff79c6>=</span> kernel_thread(kthreadd, <span style=color:#8be9fd;font-style:italic>NULL</span>, CLONE_FS <span style=color:#ff79c6>|</span> CLONE_FILES);
</span></span><span style=display:flex><span>	rcu_read_lock();
</span></span><span style=display:flex><span>	kthreadd_task <span style=color:#ff79c6>=</span> find_task_by_pid_ns(pid, <span style=color:#ff79c6>&amp;</span>init_pid_ns);
</span></span><span style=display:flex><span>	rcu_read_unlock();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * Enable might_sleep() and smp_processor_id() checks.
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * They cannot be enabled earlier because with CONFIG_PREEMPT=y
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * kernel_thread() would trigger might_sleep() splats. With
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * CONFIG_PREEMPT_VOLUNTARY=y the init task might have scheduled
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * already, but it&#39;s stuck on the kthreadd_done completion.
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 */</span>
</span></span><span style=display:flex><span>	system_state <span style=color:#ff79c6>=</span> SYSTEM_SCHEDULING;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	complete(<span style=color:#ff79c6>&amp;</span>kthreadd_done);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * The boot idle thread must execute schedule()
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * at least once to get things moving:
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 */</span>
</span></span><span style=display:flex><span>	schedule_preempt_disabled();
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/* Call into cpu_idle with preempt disabled */</span>
</span></span><span style=display:flex><span>	cpu_startup_entry(CPUHP_ONLINE);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>int</span> __ref kernel_init(<span style=color:#8be9fd>void</span> <span style=color:#ff79c6>*</span>unused)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#8be9fd>int</span> ret;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	kernel_init_freeable();
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/* need to finish all async __init code before freeing the memory */</span>
</span></span><span style=display:flex><span>	async_synchronize_full();
</span></span><span style=display:flex><span>	ftrace_free_init_mem();
</span></span><span style=display:flex><span>	jump_label_invalidate_initmem();
</span></span><span style=display:flex><span>	free_initmem();
</span></span><span style=display:flex><span>	mark_readonly();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * Kernel mappings are now finalized - update the userspace page-table
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * to finalize PTI.
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 */</span>
</span></span><span style=display:flex><span>	pti_finalize();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	system_state <span style=color:#ff79c6>=</span> SYSTEM_RUNNING;
</span></span><span style=display:flex><span>	numa_default_policy();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	rcu_end_inkernel_boot();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>if</span> (ramdisk_execute_command) {
</span></span><span style=display:flex><span>		ret <span style=color:#ff79c6>=</span> run_init_process(ramdisk_execute_command);
</span></span><span style=display:flex><span>		<span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>!</span>ret)
</span></span><span style=display:flex><span>			<span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>		pr_err(<span style=color:#f1fa8c>&#34;Failed to execute %s (error %d)</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>,
</span></span><span style=display:flex><span>		       ramdisk_execute_command, ret);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * We try each of these until one succeeds.
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 *
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * The Bourne shell can be used instead of init if we are
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * trying to recover a really broken machine.
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 */</span>
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>if</span> (execute_command) {
</span></span><span style=display:flex><span>		ret <span style=color:#ff79c6>=</span> run_init_process(execute_command);
</span></span><span style=display:flex><span>		<span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>!</span>ret)
</span></span><span style=display:flex><span>			<span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>		panic(<span style=color:#f1fa8c>&#34;Requested init %s failed (error %d).&#34;</span>,
</span></span><span style=display:flex><span>		      execute_command, ret);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>!</span>try_to_run_init_process(<span style=color:#f1fa8c>&#34;/sbin/init&#34;</span>) <span style=color:#ff79c6>||</span>
</span></span><span style=display:flex><span>	    <span style=color:#ff79c6>!</span>try_to_run_init_process(<span style=color:#f1fa8c>&#34;/etc/init&#34;</span>) <span style=color:#ff79c6>||</span>
</span></span><span style=display:flex><span>	    <span style=color:#ff79c6>!</span>try_to_run_init_process(<span style=color:#f1fa8c>&#34;/bin/init&#34;</span>) <span style=color:#ff79c6>||</span>
</span></span><span style=display:flex><span>	    <span style=color:#ff79c6>!</span>try_to_run_init_process(<span style=color:#f1fa8c>&#34;/bin/sh&#34;</span>))
</span></span><span style=display:flex><span>		<span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	panic(<span style=color:#f1fa8c>&#34;No working init found.  Try passing init= option to kernel. &#34;</span>
</span></span><span style=display:flex><span>	      <span style=color:#f1fa8c>&#34;See Linux Documentation/admin-guide/init.rst for guidance.&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> noinline <span style=color:#8be9fd>void</span> __init kernel_init_freeable(<span style=color:#8be9fd>void</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * Wait until kthreadd is all set-up.
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 */</span>
</span></span><span style=display:flex><span>	wait_for_completion(<span style=color:#ff79c6>&amp;</span>kthreadd_done);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/* Now the scheduler is fully set up and can do blocking allocations */</span>
</span></span><span style=display:flex><span>	gfp_allowed_mask <span style=color:#ff79c6>=</span> __GFP_BITS_MASK;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * init can allocate pages on any node
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 */</span>
</span></span><span style=display:flex><span>	set_mems_allowed(node_states[N_MEMORY]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	cad_pid <span style=color:#ff79c6>=</span> task_pid(current);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	smp_prepare_cpus(setup_max_cpus);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	workqueue_init();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	init_mm_internals();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	do_pre_smp_initcalls();
</span></span><span style=display:flex><span>	lockup_detector_init();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	smp_init();
</span></span><span style=display:flex><span>	sched_init_smp();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	page_alloc_init_late();
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/* Initialize page ext after all struct pages are initialized. */</span>
</span></span><span style=display:flex><span>	page_ext_init();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	do_basic_setup();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/* Open the /dev/console on the rootfs, this should never fail */</span>
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>if</span> (ksys_open((<span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> __user <span style=color:#ff79c6>*</span>) <span style=color:#f1fa8c>&#34;/dev/console&#34;</span>, O_RDWR, <span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex><span>		pr_err(<span style=color:#f1fa8c>&#34;Warning: unable to open an initial console.</span><span style=color:#f1fa8c>\n</span><span style=color:#f1fa8c>&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	(<span style=color:#8be9fd>void</span>) ksys_dup(<span style=color:#bd93f9>0</span>);
</span></span><span style=display:flex><span>	(<span style=color:#8be9fd>void</span>) ksys_dup(<span style=color:#bd93f9>0</span>);
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * check if there is an early userspace init.  If yes, let it do all
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * the work
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>!</span>ramdisk_execute_command)
</span></span><span style=display:flex><span>		ramdisk_execute_command <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;/init&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>if</span> (ksys_access((<span style=color:#ff79c6>const</span> <span style=color:#8be9fd>char</span> __user <span style=color:#ff79c6>*</span>)
</span></span><span style=display:flex><span>			ramdisk_execute_command, <span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>!=</span> <span style=color:#bd93f9>0</span>) {
</span></span><span style=display:flex><span>		ramdisk_execute_command <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>NULL</span>;
</span></span><span style=display:flex><span>		prepare_namespace();
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * Ok, we have completed the initial bootup, and
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * we&#39;re essentially up and running. Get rid of the
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * initmem segments and start the user-mode stuff..
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 *
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * rootfs is available now, try loading the public keys
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 * and default modules
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	 */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	integrity_load_keys();
</span></span><span style=display:flex><span>	load_default_modules();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * Ok, the machine is now initialized. None of the devices
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * have been touched yet, but the CPU subsystem is up and
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * running, and memory and process management works.
</span></span></span><span style=display:flex><span><span style=color:#6272a4> *
</span></span></span><span style=display:flex><span><span style=color:#6272a4> * Now we can finally start doing some real work..
</span></span></span><span style=display:flex><span><span style=color:#6272a4> */</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span> __init do_basic_setup(<span style=color:#8be9fd>void</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	cpuset_init_smp();
</span></span><span style=display:flex><span>	shmem_init();
</span></span><span style=display:flex><span>	driver_init();
</span></span><span style=display:flex><span>	init_irq_proc();
</span></span><span style=display:flex><span>	do_ctors();
</span></span><span style=display:flex><span>	usermodehelper_enable();
</span></span><span style=display:flex><span>	do_initcalls();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>void</span> __init do_initcalls(<span style=color:#8be9fd>void</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#8be9fd>int</span> level;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>for</span> (level <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; level <span style=color:#ff79c6>&lt;</span> ARRAY_SIZE(initcall_levels) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>; level<span style=color:#ff79c6>++</span>)
</span></span><span style=display:flex><span>		do_initcall_level(level);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subsys_initcall(net_dev_init);
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>int</span> __init <span style=color:#50fa7b>net_dev_init</span>(<span style=color:#8be9fd>void</span>);
</span></span></code></pre></td></tr></table></div></div><h1 id=net_dev_init>net_dev_init</h1><p>部分代码注释
linux-4.4.0</p><p>位置：<code>net/core/dev.c</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">77
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">78
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">79
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">80
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">81
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">82
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">83
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">84
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">85
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">86
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">87
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">88
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">89
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">90
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4> *  Initialize the DEV module. At boot time this walks the device list and
</span></span></span><span style=display:flex><span><span style=color:#6272a4> *  unhooks any devices that fail to initialise (normally hardware not
</span></span></span><span style=display:flex><span><span style=color:#6272a4> *  present) and leaves us with a valid list of present and active devices.
</span></span></span><span style=display:flex><span><span style=color:#6272a4> *
</span></span></span><span style=display:flex><span><span style=color:#6272a4> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4> *       This is called single threaded during boot, so no need
</span></span></span><span style=display:flex><span><span style=color:#6272a4> *       to take the rtnl semaphore.
</span></span></span><span style=display:flex><span><span style=color:#6272a4> */</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>static</span> <span style=color:#8be9fd>int</span> __init <span style=color:#50fa7b>net_dev_init</span>(<span style=color:#8be9fd>void</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> i, rc <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>-</span>ENOMEM;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    BUG_ON(<span style=color:#ff79c6>!</span>dev_boot_phase);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#6272a4>/* 初始化proc配置，创建部分文件
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	* /proc/net/dev 
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	* /proc/net/softnet_stat 
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	* /proc/net/ptype 
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	* /proc/net/dev_mcast
</span></span></span><span style=display:flex><span><span style=color:#6272a4>	*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> (dev_proc_init())
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>goto</span> out;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#6272a4>// 初始化namespace相关
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> (netdev_kobject_init())
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>goto</span> out;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    INIT_LIST_HEAD(<span style=color:#ff79c6>&amp;</span>ptype_all);
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span> (i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> PTYPE_HASH_SIZE; i<span style=color:#ff79c6>++</span>)
</span></span><span style=display:flex><span>        INIT_LIST_HEAD(<span style=color:#ff79c6>&amp;</span>ptype_base[i]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    INIT_LIST_HEAD(<span style=color:#ff79c6>&amp;</span>offload_base);
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> (register_pernet_subsys(<span style=color:#ff79c6>&amp;</span>netdev_net_ops))
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>goto</span> out;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#6272a4>/*  
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     *  Initialise the packet receive queues.
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    for_each_possible_cpu(i) {
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>struct</span> softnet_data <span style=color:#ff79c6>*</span>sd <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>&amp;</span>per_cpu(softnet_data, i);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        skb_queue_head_init(<span style=color:#ff79c6>&amp;</span>sd<span style=color:#ff79c6>-&gt;</span>input_pkt_queue);
</span></span><span style=display:flex><span>        skb_queue_head_init(<span style=color:#ff79c6>&amp;</span>sd<span style=color:#ff79c6>-&gt;</span>process_queue);
</span></span><span style=display:flex><span>        INIT_LIST_HEAD(<span style=color:#ff79c6>&amp;</span>sd<span style=color:#ff79c6>-&gt;</span>poll_list);
</span></span><span style=display:flex><span>        sd<span style=color:#ff79c6>-&gt;</span>output_queue_tailp <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>&amp;</span>sd<span style=color:#ff79c6>-&gt;</span>output_queue;
</span></span><span style=display:flex><span><span style=color:#ff79c6>#ifdef CONFIG_RPS
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>        sd<span style=color:#ff79c6>-&gt;</span>csd.func <span style=color:#ff79c6>=</span> rps_trigger_softirq;
</span></span><span style=display:flex><span>        sd<span style=color:#ff79c6>-&gt;</span>csd.info <span style=color:#ff79c6>=</span> sd;
</span></span><span style=display:flex><span>        sd<span style=color:#ff79c6>-&gt;</span>cpu <span style=color:#ff79c6>=</span> i; 
</span></span><span style=display:flex><span><span style=color:#ff79c6>#endif  
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span>
</span></span><span style=display:flex><span>        sd<span style=color:#ff79c6>-&gt;</span>backlog.poll <span style=color:#ff79c6>=</span> process_backlog;
</span></span><span style=display:flex><span>        sd<span style=color:#ff79c6>-&gt;</span>backlog.weight <span style=color:#ff79c6>=</span> weight_p;
</span></span><span style=display:flex><span>    }   
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    dev_boot_phase <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#6272a4>/* The loopback device is special if any other network devices
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * is present in a network namespace the loopback device must
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * be present. Since we now dynamically allocate and free the
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * loopback device ensure this invariant is maintained by
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * keeping the loopback device as the first device on the
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * list of network devices.  Ensuring the loopback devices
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * is the first device that appears and the last network device
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * that disappears.
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> (register_pernet_device(<span style=color:#ff79c6>&amp;</span>loopback_net_ops))
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>goto</span> out;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> (register_pernet_device(<span style=color:#ff79c6>&amp;</span>default_device_ops))
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>goto</span> out;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    open_softirq(NET_TX_SOFTIRQ, net_tx_action);
</span></span><span style=display:flex><span>    open_softirq(NET_RX_SOFTIRQ, net_rx_action);
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>	<span style=color:#6272a4>// 注册于cpu热插拔事件相关的通知链，处理cpu停止事件。
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>	<span style=color:#6272a4>// 接收到消息时，CPU入口队列里的缓冲区出列，然后传给netif_rx。
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>		
</span></span><span style=display:flex><span>    hotcpu_notifier(dev_cpu_callback, <span style=color:#bd93f9>0</span>);
</span></span><span style=display:flex><span>    dst_subsys_init();
</span></span><span style=display:flex><span>    rc <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>out</span>:
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> rc;
</span></span><span style=display:flex><span>}   
</span></span></code></pre></td></tr></table></div></div></article></div></body><div><small>words: 1790 tags:</small>
<small><code><a href=https://arair.net/tags/linux>linux</a></code></small>
<small><code><a href=https://arair.net/tags/driver>driver</a></code></small></div></html></body><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?bd28dafb59c7621d0ab721cefd01691b",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script id=LA_COLLECT src=//sdk.51.la/js-sdk-pro.min.js></script>
<script>LA.init({id:"JMTlKgP6j8mqnJSa",ck:"JMTlKgP6j8mqnJSa"})</script></html>