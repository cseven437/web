<!doctype html><html><title>rust</title><meta name=description content="Rust 语言是一种高效、可靠的通用高级语言。其高效不仅限于开发效率，它的执行效率也是令人称赞的，是一种少有的兼顾开发效率和执行效率的语言。
"><meta name=generator content="Hugo 0.88.1">
<meta property="og:title" content="rust">
<meta property="og:description" content="Rust 语言是一种高效、可靠的通用高级语言。其高效不仅限于开发效率，它的执行效率也是令人称赞的，是一种少有的兼顾开发效率和执行效率的语言。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://arair.net/posts/9e9f3bdb/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-02-09T12:55:53+08:00">
<meta property="article:modified_time" content="2021-02-20T17:37:44+08:00">
<meta itemprop=name content="rust">
<meta itemprop=description content="Rust 语言是一种高效、可靠的通用高级语言。其高效不仅限于开发效率，它的执行效率也是令人称赞的，是一种少有的兼顾开发效率和执行效率的语言。"><meta itemprop=datePublished content="2021-02-09T12:55:53+08:00">
<meta itemprop=dateModified content="2021-02-20T17:37:44+08:00">
<meta itemprop=wordCount content="472">
<meta itemprop=keywords content="rust,">
<style type=text/css>.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto;padding:45px}@media(max-width:767px){.markdown-body{padding:15px}}</style>
<script>function setTheme({el:a=document.documentElement,mode:b='auto',light:c='light',dark:d='dark'}){a.dataset.colorMode=b,a.dataset.lightTheme=c,a.dataset.darkTheme=d}let prefersDarkMode=window.matchMedia('(prefers-color-scheme: dark)').matches;prefersDarkMode&&setTheme({mode:'dark'})</script>
<link rel=stylesheet href=/style.css type=text/css><body id=content class=markdown-body>
<body>
<div id=post class=post>
<article>
<header>
<h1 class=post-title>rust</h1>
<p>
<small>
2021-02-09, updated 2021-02-20
</small>
</p>
</header>
<aside>
<nav id=TableOfContents>
<ul>
<li><a href=#交叉编译>交叉编译</a></li>
<li><a href=#安装交叉编译环境>安装交叉编译环境</a>
<ul>
<li><a href=#配置rust环境>配置rust环境</a></li>
</ul>
</li>
</ul>
<ul>
<li><a href=#配置>配置</a></li>
</ul>
<ul>
<li><a href=#updating-cratesio-index-太慢>Updating crates.io index 太慢</a></li>
<li><a href=#解决-waiting-for-file-lock-on-package-cache-lock>解决 waiting for file lock on package cache lock</a></li>
</ul>
</nav>
</aside>
<p>Rust 语言是一种高效、可靠的通用高级语言。其高效不仅限于开发效率，它的执行效率也是令人称赞的，是一种少有的兼顾开发效率和执行效率的语言。</p>
<h1 id=安装>安装</h1>
<p>官方安装方法说明：<a href=https://rustup.rs/>https://rustup.rs/</a></p>
<p>类unix平台安装命令</p>
<pre tabindex=0><code>curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
</code></pre><p>windows平台需要下载rustup-init.exe</p>
<h2 id=交叉编译>交叉编译</h2>
<h2 id=安装交叉编译环境>安装交叉编译环境</h2>
<p>使用<code>rustup target list</code>可以查看所有支持的平台，选择需要的平台</p>
<p>添加<code>armv7-unknown-linux-gnueabi</code>工具链到系统</p>
<pre tabindex=0><code>rustup target add armv7-unknown-linux-gnueabi
</code></pre><h3 id=配置rust环境>配置rust环境</h3>
<p>修改<code>~/.cargo/config</code>文件</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=p>[</span><span class=nx>target</span><span class=p>.</span><span class=nx>armv7-unknown-linux-gnueabi</span><span class=p>]</span>
<span class=nx>linker</span><span class=p>=</span><span class=s2>&#34;/.../arm-oe-linux-gnueabi-gcc&#34;</span>
</code></pre></div><blockquote>
<p>linker是指定交叉编译器的位置，可以指定编译器的路径，也可以使用系统的编译器</p>
</blockquote>
<p>编译时添加参数<code>--target armv7-unknown-linux-gnueabi</code>，如果不想添加可以在<code>~/.cargo/config</code>增加下面的配置</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=p>[</span><span class=nx>build</span><span class=p>]</span>
<span class=nx>target</span> <span class=p>=</span> <span class=s2>&#34;armv7-unknown-linux-gnueabi&#34;</span>
</code></pre></div><h1 id=cargo>cargo</h1>
<h2 id=配置>配置</h2>
<p>别名: 可以使用<code>cargo b</code>代替<code>cargo build</code></p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=p>[</span><span class=nx>alias</span><span class=p>]</span>
<span class=nx>build_aarch64</span> <span class=p>=</span> <span class=s2>&#34;build --target armv7-unknown-linux-gnueabi&#34;</span>
<span class=nx>b</span> <span class=p>=</span> <span class=s2>&#34;build&#34;</span>
</code></pre></div><h1 id=问题>问题</h1>
<h2 id=updating-cratesio-index-太慢>Updating crates.io index 太慢</h2>
<p>Rust crates.io 索引镜像使用帮助
编辑<code>~/.cargo/config</code>文件，添加以下内容：</p>
<pre tabindex=0><code class=language-conf data-lang=conf>[source.crates-io]
replace-with = 'tuna'

[source.tuna]
registry = &quot;https://mirrors.tuna.tsinghua.edu.cn/git/crates.io-index.git&quot;
</code></pre><h2 id=解决-waiting-for-file-lock-on-package-cache-lock>解决 waiting for file lock on package cache lock</h2>
<p>删除文件 <code>~/.cargo/.package-cache</code></p>
</article>
</div>
</body>
<div>
<small> words: 472 tags:</small>
<small><code><a href=https://arair.net/tags/rust>rust</a></code></small>
</div>
</html>
</body>
<script>var _hmt=_hmt||[];(function(){var a=document.createElement("script"),b;a.src="https://hm.baidu.com/hm.js?bd28dafb59c7621d0ab721cefd01691b",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)})()</script>
<script id=LA_COLLECT src=//sdk.51.la/js-sdk-pro.min.js></script>
<script>LA.init({id:"JMTlKgP6j8mqnJSa",ck:"JMTlKgP6j8mqnJSa"})</script>
<link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/default.min.css>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js></script>
<script>hljs.highlightAll()</script>
<script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script>window.onload=function(){mermaid.initialize({theme:"default"}),mermaid.init(void 0,".language-mermaid")}</script></html>