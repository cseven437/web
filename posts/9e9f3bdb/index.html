<!doctype html><html><title>rust</title><meta name=description content="Rust 语言是一种高效、可靠的通用高级语言。其高效不仅限于开发效率，它的执行效率也是令人称赞的，是一种少有的兼顾开发效率和执行效率的语言。
"><meta name=generator content="Hugo 0.84.3"><body><div id=content><body><div id=post class=post><article><header><h1 class=post-title>rust</h1><p><small>2021-02-09, updated 2021-02-20</small></p></header><aside><nav id=TableOfContents><ul><li><a href=#交叉编译>交叉编译</a></li><li><a href=#安装交叉编译环境>安装交叉编译环境</a><ul><li><a href=#配置rust环境>配置rust环境</a></li></ul></li></ul><ul><li><a href=#配置>配置</a></li></ul><ul><li><a href=#updating-cratesio-index-太慢>Updating crates.io index 太慢</a></li><li><a href=#解决-waiting-for-file-lock-on-package-cache-lock>解决 waiting for file lock on package cache lock</a></li></ul></nav></aside><p>Rust 语言是一种高效、可靠的通用高级语言。其高效不仅限于开发效率，它的执行效率也是令人称赞的，是一种少有的兼顾开发效率和执行效率的语言。</p><h1 id=安装>安装</h1><p>官方安装方法说明：<a href=https://rustup.rs/>https://rustup.rs/</a></p><p>类unix平台安装命令</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>curl --proto &#39;=https&#39; --tlsv1.2 -sSf https://sh.rustup.rs | sh
</code></pre></td></tr></table></div></div><p>windows平台需要下载rustup-init.exe</p><h2 id=交叉编译>交叉编译</h2><h2 id=安装交叉编译环境>安装交叉编译环境</h2><p>使用<code>rustup target list</code>可以查看所有支持的平台，选择需要的平台</p><p>添加<code>armv7-unknown-linux-gnueabi</code>工具链到系统</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>rustup target add armv7-unknown-linux-gnueabi
</code></pre></td></tr></table></div></div><h3 id=配置rust环境>配置rust环境</h3><p>修改<code>~/.cargo/config</code>文件</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml>[<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>armv7-unknown-linux-gnueabi</span>]
<span style=color:#a6e22e>linker</span>=<span style=color:#e6db74>&#34;/.../arm-oe-linux-gnueabi-gcc&#34;</span>
</code></pre></td></tr></table></div></div><blockquote><p>linker是指定交叉编译器的位置，可以指定编译器的路径，也可以使用系统的编译器</p></blockquote><p>编译时添加参数<code>--target armv7-unknown-linux-gnueabi</code>，如果不想添加可以在<code>~/.cargo/config</code>增加下面的配置</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml>[<span style=color:#a6e22e>build</span>]
<span style=color:#a6e22e>target</span> = <span style=color:#e6db74>&#34;armv7-unknown-linux-gnueabi&#34;</span>
</code></pre></td></tr></table></div></div><h1 id=cargo>cargo</h1><h2 id=配置>配置</h2><p>别名: 可以使用<code>cargo b</code>代替<code>cargo build</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml>[<span style=color:#a6e22e>alias</span>]
<span style=color:#a6e22e>build_aarch64</span> = <span style=color:#e6db74>&#34;build --target armv7-unknown-linux-gnueabi&#34;</span>
<span style=color:#a6e22e>b</span> = <span style=color:#e6db74>&#34;build&#34;</span>
</code></pre></td></tr></table></div></div><h1 id=问题>问题</h1><h2 id=updating-cratesio-index-太慢>Updating crates.io index 太慢</h2><p>Rust crates.io 索引镜像使用帮助
编辑<code>~/.cargo/config</code>文件，添加以下内容：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>[source.crates-io]
replace-with = &#39;tuna&#39;

[source.tuna]
registry = &#34;https://mirrors.tuna.tsinghua.edu.cn/git/crates.io-index.git&#34;
</code></pre></td></tr></table></div></div><h2 id=解决-waiting-for-file-lock-on-package-cache-lock>解决 waiting for file lock on package cache lock</h2><p>删除文件 <code>~/.cargo/.package-cache</code></p></article></div></body><div><small>words: 486 tags:</small>
<small><code><a href=https://arair.net/tags/rust>rust</a></code></small></div></html></div><script>var _hmt=_hmt||[];(function(){var a,b;if(window.location.hostname=="localhost")return;a=document.createElement("script"),a.src="https://hm.baidu.com/hm.js?bd28dafb59c7621d0ab721cefd01691b",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)})()</script></body></html>