<!doctype html><html><title>网络接口流量信息获取</title><meta name=description content="linux 记录网络接口流量信息的文件在/proc/net/dev
以下为c获相关信息示例
"><meta name=generator content="Hugo 0.84.3"><meta property="og:title" content="网络接口流量信息获取"><meta property="og:description" content="linux 记录网络接口流量信息的文件在/proc/net/dev
以下为c获相关信息示例"><meta property="og:type" content="article"><meta property="og:url" content="https://arair.net/posts/5e8aa652/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-03-16T19:40:07+08:00"><meta property="article:modified_time" content="2021-03-16T19:42:12+08:00"><meta itemprop=name content="网络接口流量信息获取"><meta itemprop=description content="linux 记录网络接口流量信息的文件在/proc/net/dev
以下为c获相关信息示例"><meta itemprop=datePublished content="2021-03-16T19:40:07+08:00"><meta itemprop=dateModified content="2021-03-16T19:42:12+08:00"><meta itemprop=wordCount content="453"><meta itemprop=keywords content="linux,network,traffic,"><body><div id=content><body><div id=post class=post><article><header><h1 class=post-title>网络接口流量信息获取</h1><p><small>2021-03-16, updated 2021-03-16</small></p></header><p>linux 记录网络接口流量信息的文件在<code>/proc/net/dev</code></p><p>以下为c获相关信息示例</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#75715e>/*
</span><span style=color:#75715e> * Inter-|   Receive                                                |  Transmit
</span><span style=color:#75715e> *  face |bytes    packets errs drop fifo frame compressed multicast|bytes    packets errs drop fifo colls carrier compressed
</span><span style=color:#75715e> *  ens33: 1378627    6509    0    0    0     0          0         0  1046428    4792    0    0    0     0       0          0
</span><span style=color:#75715e> *     lo: 10212375   78449    0    0    0     0          0         0 10212375   78449    0    0    0     0       0          0
</span><span style=color:#75715e> *  ens39:       0       0    0    0    0     0          0         0        0       0    0    0    0     0       0          0
</span><span style=color:#75715e> *  ens38: 16144882   77529    0    0    0     0          0         0   368175    3317    0    0    0     0       0          0
</span><span style=color:#75715e> */</span>

<span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;errno.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
<span style=color:#75715e>#undef long_t
</span><span style=color:#75715e>#define long_t long long unsigned 
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span>
{
    <span style=color:#66d9ef>char</span> iface[<span style=color:#ae81ff>32</span>];
    long_t rcv_bytes;
    long_t rcv_packets;
    long_t rcv_errs;
    long_t rcv_drop;
    long_t rcv_fifo;
    long_t rcv_frame;
    long_t rcv_compressed;
    long_t rcv_multicast;

    long_t snd_bytes;
    long_t snd_packets;
    long_t snd_errs;
    long_t snd_drop;
    long_t snd_fifo;
    long_t snd_colls;
    long_t snd_carrier;
    long_t snd_compressed;
}dev_st;

<span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>()
{
    FILE <span style=color:#f92672>*</span>fp <span style=color:#f92672>=</span> NULL;
    <span style=color:#66d9ef>char</span> buf[<span style=color:#ae81ff>128</span>] <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>};
    dev_st st[<span style=color:#ae81ff>10</span>];

    fp <span style=color:#f92672>=</span> fopen(<span style=color:#e6db74>&#34;/proc/net/dev&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>);
    <span style=color:#66d9ef>if</span>(fp <span style=color:#f92672>==</span> NULL) {
        perror(<span style=color:#e6db74>&#34;fopen&#34;</span>);
        <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
    }
    <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;

    fgets(buf, <span style=color:#66d9ef>sizeof</span>(buf), fp);
    fgets(buf, <span style=color:#66d9ef>sizeof</span>(buf), fp);
    memset(st, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>sizeof</span>(dev_st));
    <span style=color:#66d9ef>while</span>(fgets(buf, <span style=color:#66d9ef>sizeof</span>(buf), fp)) {
        {
            <span style=color:#75715e>// sscanf(buf, &#34;%s %llu %llu %llu %llu %llu %llu %llu %llu %llu %llu %llu %llu %llu %llu %llu %llu&#34;,
</span><span style=color:#75715e></span>            sscanf(buf, <span style=color:#e6db74>&#34;%6s: %7llu %7llu %4llu %4llu %4llu %5llu %10llu %9llu %8llu %7llu %4llu %4llu %4llu %5llu %7llu %10llu&#34;</span>,
                    st[i].iface,
                    <span style=color:#f92672>&amp;</span>st[i].rcv_bytes,
                    <span style=color:#f92672>&amp;</span>st[i].rcv_packets,
                    <span style=color:#f92672>&amp;</span>st[i].rcv_errs,
                    <span style=color:#f92672>&amp;</span>st[i].rcv_drop,
                    <span style=color:#f92672>&amp;</span>st[i].rcv_fifo,
                    <span style=color:#f92672>&amp;</span>st[i].rcv_frame,
                    <span style=color:#f92672>&amp;</span>st[i].rcv_compressed,
                    <span style=color:#f92672>&amp;</span>st[i].rcv_multicast,
                    <span style=color:#f92672>&amp;</span>st[i].snd_bytes,
                    <span style=color:#f92672>&amp;</span>st[i].snd_packets,
                    <span style=color:#f92672>&amp;</span>st[i].snd_errs,
                    <span style=color:#f92672>&amp;</span>st[i].snd_drop,
                    <span style=color:#f92672>&amp;</span>st[i].snd_fifo,
                    <span style=color:#f92672>&amp;</span>st[i].snd_colls,
                    <span style=color:#f92672>&amp;</span>st[i].snd_carrier,
                    <span style=color:#f92672>&amp;</span>st[i].snd_compressed);
            st[i].iface[strlen(st[i].iface)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;\0&#39;</span>;
        }
        i<span style=color:#f92672>++</span>;
    }

    <span style=color:#66d9ef>for</span>(i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>;i <span style=color:#f92672>++</span>)
    {
        printf(<span style=color:#e6db74>&#34;st[%d].iface:%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].iface);
        printf(<span style=color:#e6db74>&#34;st[%d].rcv_bytes:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].rcv_bytes);
        printf(<span style=color:#e6db74>&#34;st[%d].rcv_packets:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].rcv_packets);
        printf(<span style=color:#e6db74>&#34;st[%d].rcv_errs:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].rcv_errs);
        printf(<span style=color:#e6db74>&#34;st[%d].rcv_drop:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].rcv_drop);
        printf(<span style=color:#e6db74>&#34;st[%d].rcv_fifo:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].rcv_fifo);
        printf(<span style=color:#e6db74>&#34;st[%d].rcv_frame:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].rcv_frame);
        printf(<span style=color:#e6db74>&#34;st[%d].rcv_compressed:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].rcv_compressed);
        printf(<span style=color:#e6db74>&#34;st[%d].rcv_multicast:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].rcv_multicast);
        printf(<span style=color:#e6db74>&#34;st[%d].snd_bytes:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].snd_bytes);
        printf(<span style=color:#e6db74>&#34;st[%d].snd_packets:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].snd_packets);
        printf(<span style=color:#e6db74>&#34;st[%d].snd_errs:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].snd_errs);
        printf(<span style=color:#e6db74>&#34;st[%d].snd_drop:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].snd_drop);
        printf(<span style=color:#e6db74>&#34;st[%d].snd_fifo:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].snd_fifo);
        printf(<span style=color:#e6db74>&#34;st[%d].snd_colls:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].snd_colls);
        printf(<span style=color:#e6db74>&#34;st[%d].snd_carrier:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].snd_carrier);
        printf(<span style=color:#e6db74>&#34;st[%d].snd_compressed:%llu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, i, st[i].snd_compressed);
        printf(<span style=color:#e6db74>&#34;----------------------------------------------------------</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
    }


    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
}
</code></pre></td></tr></table></div></div></article></div></body><div><small>words: 453 tags:</small>
<small><code><a href=https://arair.net/tags/linux>linux</a></code></small>
<small><code><a href=https://arair.net/tags/network>network</a></code></small>
<small><code><a href=https://arair.net/tags/traffic>traffic</a></code></small></div></html></div><script>var _hmt=_hmt||[];(function(){var a,b;if(window.location.hostname=="localhost")return;a=document.createElement("script"),a.src="https://hm.baidu.com/hm.js?bd28dafb59c7621d0ab721cefd01691b",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)})()</script></body></html>